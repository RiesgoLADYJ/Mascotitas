
    <script src="//maps.google.com/maps/api/js?v=3.23&sensor=false&client=&key=&libraries=geometry&language=&hl=&region="></script> 
    <script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>

    <script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <link href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://pingendo.github.io/pingendo-bootstrap/themes/default/bootstrap.css" rel="stylesheet" type="text/css">
<p id="notice"><%= notice %></p>

<h1>Listing Pets</h1>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Specie</th>
      <th>Age</th>
      <th>Gender</th>
      <th>Race</th>
      <th>Size</th>
      <th>Sterilized</th>
      <th>Avatar</th>
      <th>User</th>
      <th>Adoption</th>
      <th>Vaccine</th>
      <th>Duen√±o</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @pets.each do |pet| %>
      <tr>
        <td><%= pet.name %></td>
        <td><%= pet.specie %></td>
        <td><%= pet.age %></td>
        <td><%= pet.gender %></td>
        <td><%= pet.race %></td>
        <td><%= pet.size %></td>
        <td><%= pet.sterilized %></td>
        <td><%= pet.avatar %></td>
        <td><%= pet.user_id %></td>
        <td><%= pet.adoption %></td>
        <td><%= pet.vaccine %></td>
        <td><%= pet.user.email %></td>

        <td><%= link_to 'Show', pet %></td>
        <td><%= link_to 'Edit', edit_pet_path(pet) %></td>
        <td><%= link_to 'Destroy', pet, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= javascript_tag do%>
 window.nearbys= <%=raw @pets.to_json %>;

<%end%>
<div id='map_canvas'></div>
<script type="text/javascript">

function myFunction(identificador){

}



var map = new google.maps.Map(document.getElementById('map_canvas'), {
    zoom: 11,
    center: new google.maps.LatLng(19.434,-99.133),
    mapTypeId: google.maps.MapTypeId.ROADMAP
});

function verMascota(llave){
  
}

var markers=[];
    var infoWindowContent=[];
    $.each(nearbys, function(index) { 
        var pets = <%=raw @pets_m.to_json%>;
        console.log( [pets[index][0]+ " " +pets[index][1]+" "+pets[index][2]+" "+pets[index][3]]);

        console.log( [nearbys[index]['name']+ " " +nearbys[index]['user_id']+" "+nearbys[index]['user.lng']]);
        markers.push([pets[index][0],pets[index][1],pets[index][2]]);
        infoWindowContent.push(['<div class="info_content" >' +'<button onclick="verMascota()"> Click me</button>'+
        '<h3 style="color: rgb(<%= rand(0..200)%>,<%= rand(0..200)%> ,<%= rand(0..200)%>);">'+nearbys[index]['name']+'</h3>' +'</br>'+
        '<p>'+nearbys[index]['name']+'</p>' +       
         '</div>']);

        });   

       // Display multiple markers on a map
       var infoWindow = new google.maps.InfoWindow(), marker, i;        
      // Loop through our array of markers & place each one on the map  
      for( i = 0; i < markers.length; i++ ) {
          var position = new google.maps.LatLng(markers[i][1], markers[i][2]);
          marker = new google.maps.Marker({
            position: position,
            map: map,
            title: markers[i][0]
        });

        // Allow each marker to have an info window    
        google.maps.event.addListener(marker, 'click', (function(marker, i) {
            return function() {
                infoWindow.setContent(infoWindowContent[i][0]);
                infoWindow.open(map, marker);


            }
        })(marker, i));


    
    }

    // Override our map zoom level once our fitBounds function runs (Make sure it only runs once)
    var boundsListener = google.maps.event.addListener((map), 'bounds_changed', function(event) {
        this.setZoom(14);
        google.maps.event.removeListener(boundsListener);
    });

</script>
<br>

<%= link_to 'New Pet', new_pet_path %>
